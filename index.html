<!DOCTYPE html>
<html>
  <head>
    <title>皇位継承シミュレーター</title>
    <link rel="stylesheet" href="lib/c3.min.css">
    <script type="text/javascript" src="lib/vis-network.min.js"></script>
    <script type="text/javascript" src="lib/c3.min.js"></script>
    <script type="text/javascript" src="lib/d3.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="app/keizu_main.css">
  </head>

  <body>
    <header id="i_title" class="c_part">
      <div class="c_title">
        <h2>皇位継承シミュレーター</h2>
      </div>
      <div class="c_note c_header">
        できれば男系で皇位継承したい。男系で継承できるのか？どうすれば安定して継承できるのか？を検討するシミュレーターです。指定の条件で皇位を30代（おおよそ千年）継承できる確率と、想定される系図の例を表示します。
      </div>
    </header>

    <div class="c_contents">

    <div class="c_kakuritsu c_part">

    <h3>設定</h3>
    <table>  
      <tr>
      <td class="c_label">天皇の子の数(1～10)</td>
      <td class="c_input"><input type="number" class="c_iform" id="i_numChild" value="3.5" min="1.0" max="10.0"></td>
      </tr>
      <tr>
      <td class="c_label">男子の割合(％)</td>
      <td class="c_input"><input type="number" class="c_iform" id="i_maleRatio" value="51.3" min="10.0" max="100.0"></td>
      </tr>
      <tr>
      <td class="c_label">遡る世代の上限(1～10)</td>
      <td class="c_input"><input type="number" class="c_iform" id="i_ancLimit" value="3" min="1" max="10"></td>
      </tr>
    </table>

    <details>
      <summary>詳細設定</summary>
      <table>  
        <tr>
          <td class="c_label">計算する世代(2～30)</td>
          <td class="c_input"><input type="number" class="c_iform" id="i_generation" value="30" min="2" max="30"></td>
        </tr>
        <tr>
          <td class="c_label">計算パターン数(1～100(万回))</td>
          <td class="c_input"><input type="number" class="c_iform" id="i_numPattern" value="10" min="1" max="100">
            <label for="i_seed"></label></td>
        </tr>
      </table>
    </details>

    <details>
      <summary>設定の解説</summary>
      <div class="c_note">このシミュレーションでは、指定した「子供の数」と「男子の割合」で男系天皇を30代継続できるかどうかを計算します。子供の性別は乱数で決めつつ、30代続く系図を10万回作ります。系図を作る過程で子供がすべて女子であれば先祖を遡って親戚の男系男子を探しますが、指定した「遡る世代の上限」までさかのぼっても男系男子がいない場合は継承が失敗したものとします。10万回系図を作った中で、30代継承できた割合を継承成功率としています。起点となるのは「未来の架空の天皇」であり、その天皇まで同じ条件で継承されていると仮定します。なお、兄弟間の継承は考慮していません。</div>
      <div class="c_noteTitle">天皇の子の数</div>
      <div class="c_note">小数点で指定できます（2.5なら1/2の確率で子供が2人か3人になります）。多いほど男子が生まれる確率が高まり、4人以上だとかなり安定して継承できます。今の日本では子供が１～３人の家庭が多いですが、昭和初期だと５～６人いる家庭が普通でした。不妊などの理由で子を持たない天皇も出てくるでしょうから、子を産む数より少なめの数を指定したほうがよいです。側室制度（一夫多妻制）や代理母出産などを採用すれば多数の子を持ちやすいですが、現在の日本の価値観では国民の理解は得にくそうです。また、多くの子を産むことは皇族の方々にとって喜びであると同時にプレッシャーかもしれません。</div>
      <div class="c_noteTitle">男子の割合</div>
      <div class="c_note">生まれた子が男子である割合です。自然出産では統計的に男子が51.3%程度なので初期値にしています。この値は産み分け技術により高めることが可能です。「産み分け」で検索すると産み分け指導をしている病院の情報を得られますが、70～80％の確率で男子を産めるとのことです。産み分けをすることで、子供が少なくても男子の数を増やすことが可能です。しかし、皇族が男子ばかりになるのは問題でしょうし、皇族の方々にとって産み分けは心身ともに負担であると思います。なお、日本では規制されていますが着床前診断という方法を使うと100％男子を産み分けることが可能です。アメリカでは規制されていませんし、将来的には日本でも少子化対策を兼ねて解禁できるかもしれません（産み分けできるならもう一人産みたいと思う一般ご夫婦は少なくないと思います）。</div>
      <div class="c_noteTitle">遡る世代の上限</div>
      <div class="c_note">子供がすべて女子の場合、先祖をさかのぼって親戚の男系男子を探しますが、何代までさかのぼるかを指定します。たとえば甥（兄弟の息子）がいるときは（新天皇から見て）祖父の代まで2代さかのぼります。この数が多いほど親戚が増えて継承しやすくなりますが、あまり遠い親戚が新しい天皇になると国民が親しみを持てない可能性があります。感覚的には3代程度、多くとも歴代で最も遡った（継体天皇）5代以下が望ましいでしょう。なお、この数字を増やすことは宮家を増やすこと、遠縁の皇族を増やすことに相当します。遠縁であっても皇族として活動していれば国民も親しみを持てるかもしれません。また、子供や男子の割合を増やすことに比べると皇族の方々の心身の負担は少ないでしょう。なお、天皇と近縁の女性皇族（たとえば愛子様）が遠縁の男系皇族と結婚すれば親しみと男系とを両立できるという考えもあります。</div>
      <div class="c_noteTitle">計算する世代</div>
      <div class="c_note">何世代先までの系図を作るかを指定します。おおよそ千年の30世代を初期値にしています。少ない世代のほうが継承成功率は高まります。</div>
      <div class="c_noteTitle">計算パターン数</div>
      <div class="c_note">指定した条件で何回系図を作るかを指定します。初期値は10万回ですが、この場合成功率は経験的に最大±0.5％程度の誤差があります。回数を増やすと誤差が小さくなりますが、計算時間が増えます。（本当は厳密な確率の計算式を見出せそうですが、私がそれを考えるより何万回も計算しちゃったほうが速いので、ご不便おかけしますがご了承ください。）</div>
    </details>

    <h3>継承成功率</h3>
    <div id="c3_pie"></div>
    <div id="i_seikouritsu" class="c_caption">30代継承成功率</div>
    <div id="c3_hist"></div>
    <div class="c_caption">継承成功時の最高遡り数(代)</div>

    <div id="i_statStat" class="c_result">確率情報</div>

    <details>
      <summary>成功率の解説</summary>
      <div class="c_noteTitle">30代継承成功率</div>
      <div class="c_note">男系天皇を30代継承できる確率です。どの程度の成功率を目標とすべきなのか私にも判断が難しいです。50％以上で十分かもしれませんし、国家の大事であるから99％以上を目指すべきかもしれません。また、おおよそ千年30代を基準にしていますが、10代とか20代とかもっと短い世代で検討してよいかもしれません。なお、継承が失敗した場合も天皇が断絶するわけではなく、「遡る世代の上限」より遠縁の男系男子や女系の天皇を認めることで皇位は継承できます。</div>
      <div class="c_noteTitle">継承成功時の最高遡り数</div>
      <div class="c_note">系図を作ったときにもっとも先祖をさかのぼった世代数を横軸、10万回系図を作った時のその頻度を縦軸の棒グラフで示します。継承に成功した系図のみ対象にしています。左側の棒が長いほど近縁で継承できているので望ましい状態です。</div>
      <div class="c_noteTitle">平均最高遡り数</div>
      <div class="c_note">系図を作ったときにもっとも先祖をさかのぼった世代数の平均です。継承に成功した系図のみ対象にしています。数字が1に近いほど近縁で継承できているので望ましい状態です。</div>
      <div class="c_noteTitle">嫡子継承率</div>
      <div class="c_note">系図を作ったときに（甥などの親戚でなく）子供が皇位を継承した割合です。継承に成功した系図のみ対象にしています。数字が大きいほど近縁で継承できているので望ましい状態です。</div>
    </details>
    </div>

    <div class="c_keizu c_part">
    <h3>系図の例</h3>
    <table>  
      <tr>
        <td class="c_label" id="i_dispPattern">表示系図パターン(1～100000)</td>
        <td class="c_input"><input type="number" class="c_iform" id="i_pattern" value="1" min="1" max="1000000"></td>
      </tr>
      <tr>
      <td class="c_label">直系以外は隠す</td>
      <td class="c_input"><input type="checkbox" id="i_hideBranch"></td>
    </tr>
    </table>
    <div id="i_stat" class="c_result">
      継承
    </div>

    <div id="mynetwork"></div>
    <div id="i_copyright" class="c_note">
      (C)fujas 2021 確率的に想定される系図のほんの一例です。
    </div>

    <details>
      <summary>系図の解説</summary>
      <div class="c_noteTitle">表示系図パターン</div>
      <div class="c_note">10万個作った系図のうち、表示する系図のパターン番号を指定します。プログラム的には、この値をランダムシードとして系図を生成しています。</div>
      <div class="c_noteTitle">直系以外は隠す</div>
      <div class="c_note">チェックマークをつけると、天皇とその直系の先祖のみを表示します。</div>
      <div class="c_noteTitle">系図</div>
      <div class="c_note">濃い青が天皇、薄い青は天皇ではない男子皇族、緑色は天皇ではないが天皇の先祖である男子皇族、ピンク色が女子皇族です。起点となるのは「未来の架空の天皇」であり、その天皇まで同じ条件で継承されていると仮定します。マウスホイールやピンチ操作で図を拡大できます。</div>
    </details>
    </div>

    </div>

    <footer>
    <div id="i_note" class="c_note c_footer">
      (C)fujas 2021 本サイトとスクリプトはfujasの著作物です。許可なく転載・複製することを禁じます。
      ただし、今後ライセンス形態を変えるかもしれません。
      グラフおよび系図は本サイト著作者の許可なく自由に転載可能です。
      ただし、系図については図の近くに「(C)fujas 2021 確率的に想定される系図のほんの一例です」と明記してください。
      勉強不足なので間違いや不適切な表現が多々あると思います。ご意見ご要望は githubfujas @gm ail.c om までお気軽にご連絡ください（スペースを省いたものがメールアドレス）。
    </div>
    <div id="i_note" class="c_note c_footer">
    </div>
    </footer>

    <script src="lib/jquery-3.5.1.slim.min.js"></script>
    <script type="text/javascript" src="app/keizu_main.js"></script>
  
  </body>
</html>
